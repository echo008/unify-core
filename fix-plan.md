# Unify-Core é¡¹ç›®ä¿®å¤è®¡åˆ’

## é¡¹ç›®çœŸå®çŠ¶æ€ (åŸºäº2025-09-06 21:14å®é™…æµ‹è¯•)
- **æœ€æ–°æ£€æŸ¥æ—¶é—´**: 2025-09-06 21:14
- **æ„å»ºçŠ¶æ€**: âŒ **Androidå¹³å°ç¼–è¯‘å¤±è´¥**
- **ä¸»è¦é—®é¢˜**: expect/actualæ¥å£ä¸åŒ¹é…å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯
- **å½±å“èŒƒå›´**: Androidå¹³å°æ— æ³•ç¼–è¯‘ï¼Œå…¶ä»–å¹³å°å¾…æµ‹è¯•
- **ç´§æ€¥ç¨‹åº¦**: ğŸ”´ **é«˜ä¼˜å…ˆçº§ä¿®å¤**

## å®é™…ç¼–è¯‘é”™è¯¯åˆ†æ

### ğŸ”´ æ ¸å¿ƒç¼–è¯‘é”™è¯¯ (åŸºäºå®é™…æµ‹è¯•)

#### 1. Androidå†…å­˜ç®¡ç†å™¨expect/actualä¸åŒ¹é…
**é”™è¯¯æ•°é‡**: 14ä¸ªç¼–è¯‘é”™è¯¯
**æ–‡ä»¶**: `/shared/src/androidMain/kotlin/com/unify/core/memory/UnifyMemoryManager.android.kt`
**å…·ä½“é”™è¯¯**:
```
- No value passed for parameter 'directMemoryUsed' (line 32)
- No value passed for parameter 'directMemoryMax' (line 39)
- No value passed for parameter 'usagePercentage' (line 39)
- Cannot find parameter 'gcCount', 'gcTime', 'youngGenGC', 'oldGenGC', 'lastGCDuration' (lines 46-50)
- Missing required parameters in GCInfo constructor
```

**æ ¹æœ¬åŸå› **: 
- commonMainä¸­å®šä¹‰çš„MemoryUsageå’ŒGCInfoæ•°æ®ç±»å‚æ•°ä¸androidMainå®ç°ä¸åŒ¹é…
- expectå‡½æ•°ç­¾åä¸actualå®ç°ä¸ä¸€è‡´

## ğŸ”§ åŸºäºäº‹å®çš„ä¿®å¤è®¡åˆ’

### é˜¶æ®µ1: ä¿®å¤Androidå†…å­˜ç®¡ç†å™¨expect/actualä¸åŒ¹é… (ç´§æ€¥)
**é¢„è®¡æ—¶é—´**: 2-3å°æ—¶
**ä¼˜å…ˆçº§**: ğŸ”´ æœ€é«˜

**å…·ä½“ä¿®å¤ä»»åŠ¡**:
1. **ä¿®å¤MemoryUsageæ•°æ®ç±»ä¸åŒ¹é…**
   - åœ¨androidMainå®ç°ä¸­è¡¥å……ç¼ºå¤±çš„å‚æ•°: `directMemoryUsed`, `directMemoryMax`, `usagePercentage`
   - è®¡ç®—usagePercentage = (usedMemory.toFloat() / maxMemory) * 100f
   - è®¾ç½®directMemoryç›¸å…³å‚æ•°ä¸º0L (Androidä¸æ”¯æŒç›´æ¥å†…å­˜ç»Ÿè®¡)

2. **ä¿®å¤GCInfoæ•°æ®ç±»ä¸åŒ¹é…**
   - æ›´æ–°androidMainä¸­çš„GCInfoæ„é€ å‡½æ•°è°ƒç”¨
   - è¡¥å……æ‰€æœ‰å¿…éœ€å‚æ•°: `youngGenCollections`, `youngGenTime`, `oldGenCollections`, `oldGenTime`, `totalCollections`, `totalTime`, `lastGCTime`, `averageGCTime`
   - Androidå¹³å°è®¾ç½®ä¸ºé»˜è®¤å€¼0Lå’Œ0.0 (Androidä¸æä¾›è¯¦ç»†GCç»Ÿè®¡)

3. **éªŒè¯ä¿®å¤ç»“æœ**
   ```bash
   ./gradlew :shared:compileDebugKotlinAndroid
   ```

### é˜¶æ®µ2: æ£€æŸ¥å…¶ä»–å¹³å°ç¼–è¯‘çŠ¶æ€ (é«˜)
**é¢„è®¡æ—¶é—´**: 1-2å°æ—¶
**ä¼˜å…ˆçº§**: ğŸŸ¡ é«˜

**å…·ä½“éªŒè¯ä»»åŠ¡**:
1. **æµ‹è¯•iOSå¹³å°ç¼–è¯‘**
   ```bash
   ./gradlew :shared:compileKotlinIosX64
   ```

2. **æµ‹è¯•Web/JSå¹³å°ç¼–è¯‘**
   ```bash
   ./gradlew :shared:compileKotlinJs
   ```

3. **æµ‹è¯•Desktop/JVMå¹³å°ç¼–è¯‘**
   ```bash
   ./gradlew :shared:compileKotlinJvm
   ```

### é˜¶æ®µ3: ä¿®å¤å‘ç°çš„å…¶ä»–å¹³å°é—®é¢˜ (ä¸­)
**é¢„è®¡æ—¶é—´**: æ ¹æ®å‘ç°çš„é—®é¢˜è€Œå®š
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä¸­

**å…·ä½“ä¿®å¤ä»»åŠ¡**:
- æ ¹æ®é˜¶æ®µ2æµ‹è¯•ç»“æœï¼Œä¿®å¤å…¶ä»–å¹³å°çš„ç±»ä¼¼expect/actualä¸åŒ¹é…é—®é¢˜
- ç¡®ä¿æ‰€æœ‰å¹³å°çš„æ•°æ®ç±»æ„é€ å‡½æ•°å‚æ•°ä¸€è‡´

## â° å®é™…ä¿®å¤æ—¶é—´è¡¨

| é˜¶æ®µ | ä»»åŠ¡ | é¢„è®¡æ—¶é—´ | çŠ¶æ€ |
|------|------|----------|---------|
| é˜¶æ®µ1 | Androidå†…å­˜ç®¡ç†å™¨expect/actualä¿®å¤ | 2-3å°æ—¶ | â³ å¾…å¼€å§‹ |
| é˜¶æ®µ2 | å…¶ä»–å¹³å°ç¼–è¯‘çŠ¶æ€æ£€æŸ¥ | 1-2å°æ—¶ | â³ å¾…å¼€å§‹ |
| é˜¶æ®µ3 | ä¿®å¤å‘ç°çš„å…¶ä»–å¹³å°é—®é¢˜ | å¾…å®š | â³ å¾…å¼€å§‹ |

**æ€»è®¡é¢„ä¼°æ—¶é—´**: 3-5å°æ—¶ (1ä¸ªå·¥ä½œæ—¥å†…)

## ğŸ¯ æˆåŠŸæ ‡å‡† (åŸºäºå®é™…æµ‹è¯•)

### ç¼–è¯‘æˆåŠŸæ ‡å‡†
- [ ] Androidå¹³å°ç¼–è¯‘é€šè¿‡ (0ä¸ªé”™è¯¯)
- [ ] iOSå¹³å°ç¼–è¯‘é€šè¿‡
- [ ] Web/JSå¹³å°ç¼–è¯‘é€šè¿‡  
- [ ] Desktop/JVMå¹³å°ç¼–è¯‘é€šè¿‡
- [ ] æ‰€æœ‰expect/actualæ¥å£åŒ¹é…
- [ ] æ„å»ºæ—¶é—´ < 5åˆ†é’Ÿ

### è´¨é‡æ ‡å‡†
- [ ] 0ä¸ªç¼–è¯‘é”™è¯¯
- [ ] æ‰€æœ‰å¹³å°æ„å»ºæˆåŠŸ
- [ ] expect/actualæ¥å£ä¸€è‡´æ€§100%
- [ ] æ•°æ®ç±»æ„é€ å‡½æ•°å‚æ•°å®Œæ•´

## âš ï¸ é£é™©è¯„ä¼° (åŸºäºå®é™…æƒ…å†µ)

### ğŸ”´ é«˜é£é™©
1. **å…¶ä»–å¹³å°å¯èƒ½å­˜åœ¨ç›¸åŒé—®é¢˜**
   - iOSã€Webã€Desktopå¹³å°å¯èƒ½ä¹Ÿæœ‰expect/actualä¸åŒ¹é…
   - å½±å“: å¯èƒ½éœ€è¦é¢å¤–1-3å°æ—¶ä¿®å¤

2. **æ•°æ®ç±»è®¾è®¡é—®é¢˜**
   - æŸäº›å¹³å°æ— æ³•æä¾›æ‰€æœ‰å‚æ•°çš„çœŸå®å€¼
   - å½±å“: éœ€è¦åˆç†è®¾ç½®é»˜è®¤å€¼

### ğŸŸ¡ ä¸­é£é™©  
1. **å¹³å°ç‰¹å®šå®ç°å·®å¼‚**
   - ä¸åŒå¹³å°çš„å†…å­˜ç®¡ç†APIå·®å¼‚è¾ƒå¤§
   - å½±å“: éœ€è¦é’ˆå¯¹æ€§é€‚é…

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¼€å§‹**: ä¿®å¤Androidå†…å­˜ç®¡ç†å™¨çš„expect/actualä¸åŒ¹é…é—®é¢˜
2. **é€æ­¥éªŒè¯**: ä¿®å¤ä¸€ä¸ªé—®é¢˜ç«‹å³æµ‹è¯•ç¼–è¯‘
3. **å…¨é¢æ£€æŸ¥**: æµ‹è¯•æ‰€æœ‰å¹³å°ç¼–è¯‘çŠ¶æ€
4. **è®°å½•è¿›åº¦**: æ›´æ–°ä¿®å¤çŠ¶æ€å’Œæ–°å‘ç°çš„é—®é¢˜

## ğŸ” é—®é¢˜æ ¹å› åˆ†æ

### ä¸ºä»€ä¹ˆä¹‹å‰ä¿®å¤è¿›å±•ç¼“æ…¢ï¼Ÿ
1. **é—®é¢˜å®šä½ä¸å‡†ç¡®**: ä¹‹å‰å…³æ³¨çš„å­˜å‚¨ç»„ä»¶ã€KtLintç­‰é—®é¢˜å¹¶éå½“å‰é˜»å¡ç¼–è¯‘çš„æ ¸å¿ƒé—®é¢˜
2. **ç¼ºä¹å®é™…æµ‹è¯•**: æ²¡æœ‰åŸºäºçœŸå®ç¼–è¯‘é”™è¯¯è¿›è¡Œåˆ†æï¼Œå¯¼è‡´ä¿®å¤æ–¹å‘é”™è¯¯
3. **expect/actualæœºåˆ¶ç†è§£ä¸è¶³**: è¿™æ˜¯Kotlin Multiplatformçš„æ ¸å¿ƒæœºåˆ¶ï¼Œæ¥å£ä¸åŒ¹é…ä¼šç›´æ¥å¯¼è‡´ç¼–è¯‘å¤±è´¥
4. **æ•°æ®ç±»è®¾è®¡ä¸å®Œå–„**: commonMainä¸­å®šä¹‰çš„æ•°æ®ç±»å‚æ•°ä¸å¹³å°å®ç°ä¸ä¸€è‡´

### æœ¬æ¬¡ä¿®å¤çš„æ”¹è¿›
1. **åŸºäºå®é™…ç¼–è¯‘é”™è¯¯**: ç›´æ¥åˆ†æçœŸå®çš„ç¼–è¯‘è¾“å‡ºï¼Œå®šä½å…·ä½“é—®é¢˜
2. **èšç„¦æ ¸å¿ƒé—®é¢˜**: ä¼˜å…ˆè§£å†³é˜»å¡ç¼–è¯‘çš„å…³é”®é”™è¯¯
3. **é€æ­¥éªŒè¯**: æ¯ä¸ªä¿®å¤éƒ½ç«‹å³éªŒè¯ï¼Œç¡®ä¿è¿›å±•
4. **å…¨é¢æ£€æŸ¥**: ä¿®å¤ä¸€ä¸ªå¹³å°åç«‹å³æ£€æŸ¥å…¶ä»–å¹³å°çŠ¶æ€

---

**å½“å‰çŠ¶æ€**: âŒ **Androidå¹³å°ç¼–è¯‘å¤±è´¥ï¼Œexpect/actualæ¥å£ä¸åŒ¹é…**  
**ä¸‹ä¸€æ­¥**: ç«‹å³ä¿®å¤Androidå†…å­˜ç®¡ç†å™¨çš„æ•°æ®ç±»å‚æ•°ä¸åŒ¹é…é—®é¢˜  
**é¢„æœŸå®Œæˆ**: 1ä¸ªå·¥ä½œæ—¥å†…å®ç°æ‰€æœ‰å¹³å°ç¼–è¯‘é€šè¿‡
